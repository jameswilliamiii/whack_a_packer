<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Loom SDK: Whack-A-Mole </title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width">

        <link rel="stylesheet" href="../../css/pages.css">
        <link rel="stylesheet" href="../../css/pygments.css">
        <link type="text/css" rel="stylesheet" href="../../css/jquery.dropdown.css" />
    </head>
    <body>

        <div id="top">&nbsp;</div>

        <!-- Header. -->
<header class="site-header">
    <div class="site-header__logo">
        <div class="site-header__logo__version">???</div>
    </div>
    <ul class="site-header__nav breadcrumb">
        <li><a href="../../index.html" class="is-perm">Home</a>
          <li><a class='is-perm' href='../../examples/index.html'>Examples</a><li>Whack-A-Mole
    </ul>
    <div id="site-header__search" class="site-header__search" data-dropdown="#results-dropdown">
        <input type="text"><button><span class="down-arrow"></span><span class="text">Search all</span></button>
        <div class="options">
            <div class="options__option options__option--selected" name="search-all">Search all</div>
            <div class="options__option" name="classes">Classes</div>
            <div class="options__option" name="examples">Examples</div>
            <div class="options__option" name="guides">Guides</div>
        </div>
    </div>
    <div id="results-dropdown" class="dropdown dropdown-tip dropdown-relative">
        <ul class="dropdown-menu">
        </ul>
    </div>
</header><!-- End header. -->


        <!-- Sidebar. -->
<div id="sidebar" class="sidebar">
    <div class="sidebar__inner">
        <div class="sidebar__button">
            <img src="../../images/sidebar__button__icon.png" class="sidebar__button__icon" />
        </div>
        <div class="sidebar__title">
            <img src="../../images/sidebar__title.png" />
        </div>
        <div class="sidebar__body">
        </div>
    </div>
</div><!-- End sidebar. -->

        <div class="page">

          <!-- Page nav. -->
          <nav class="page-nav">
              <h4 class="page-nav__title">Whack-A-Mole</h4>
              <ul id="page-nav__list" class="page-nav__list">
              </ul>
          </nav><!-- End page nav. -->

          <div class="content">

            <header class="content-header">
              <h1>Whack-A-Mole</h1>
            </header>

            <p>
              <h2 id="toc_0">Overview</h2>

<p>A super simple Whack-A-Mole game.</p>

<h2 id="toc_1">Try It</h2>

<p>Use the following Loom CLI commands to run this example:</p>
<div class="highlight"><pre>loom new MyWhackAMole --example WhackAMole
<span class="nb">cd </span>MyWhackAMole
loom run
</pre></div>
<h2 id="toc_2">Screenshot</h2>

<p><img src="images/screenshot.png" alt="WhackAMole Screenshot"></p>

<h2 id="toc_3">Code</h2>

<p><em>src/WhackAMole.ls</em></p>
<div class="highlight"><pre><span class="kd">package</span>
<span class="o">{</span>

    <span class="k">import</span> <span class="nn">loom.Application</span><span class="o">;</span>    
    <span class="k">import</span> <span class="nn">loom.platform.Timer</span><span class="o">;</span>

    <span class="k">import</span> <span class="nn">loom2d.Loom2D</span><span class="o">;</span>
    <span class="k">import</span> <span class="nn">loom2d.display.Image</span><span class="o">;</span>        
    <span class="k">import</span> <span class="nn">loom2d.display.StageScaleMode</span><span class="o">;</span>
    <span class="k">import</span> <span class="nn">loom2d.animation.Transitions</span><span class="o">;</span>
    <span class="k">import</span> <span class="nn">loom2d.textures.Texture</span><span class="o">;</span>
    <span class="k">import</span> <span class="nn">loom2d.ui.SimpleLabel</span><span class="o">;</span>
    <span class="k">import</span> <span class="nn">loom2d.events.Touch</span><span class="o">;</span>
    <span class="k">import</span> <span class="nn">loom2d.events.TouchEvent</span><span class="o">;</span>
    <span class="k">import</span> <span class="nn">loom2d.events.TouchPhase</span><span class="o">;</span>

    <span class="k">import</span> <span class="nn">loom2d.math.Point</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kd">class</span> <span class="n">WhackAMole</span> <span class="kd">extends</span> <span class="n">Application</span>
    <span class="o">{</span>
        <span class="kd">protected</span> <span class="kd">var</span> <span class="n">timer</span><span class="p">:</span><span class="kt">Timer</span><span class="o">;</span>
        <span class="kd">protected</span> <span class="kd">var</span> <span class="n">moles</span><span class="p">:</span><span class="kt">Vector.&lt;Image&gt;</span><span class="o">;</span>
        <span class="kd">protected</span> <span class="kd">var</span> <span class="n">moleStates</span><span class="p">:</span><span class="kt">Vector.&lt;Boolean&gt;</span><span class="o">;</span>
        <span class="kd">protected</span> <span class="kd">var</span> <span class="n">scores</span><span class="p">:</span><span class="kt">Vector.&lt;SimpleLabel&gt;</span><span class="o">;</span>
        <span class="kd">protected</span> <span class="kd">var</span> <span class="n">misses</span><span class="p">:</span><span class="kt">Vector.&lt;SimpleLabel&gt;</span><span class="o">;</span>
        <span class="kd">protected</span> <span class="kd">var</span> <span class="n">waitTime</span><span class="p">:</span><span class="kt">Number</span><span class="o">;</span>
        <span class="kd">protected</span> <span class="kd">var</span> <span class="n">totalScore</span><span class="p">:</span><span class="kt">SimpleLabel</span><span class="o">;</span>
        <span class="kd">protected</span> <span class="kd">var</span> <span class="n">total</span><span class="p">:</span><span class="kt">Number</span><span class="o">;</span>
        <span class="kd">protected</span> <span class="kd">var</span> <span class="n">strikes</span><span class="p">:</span><span class="kt">Number</span><span class="o">;</span>
        <span class="kd">protected</span> <span class="kd">var</span> <span class="n">retryButton</span><span class="p">:</span><span class="kt">Image</span><span class="o">;</span>
        <span class="kd">protected</span> <span class="kd">var</span> <span class="n">timeLabel</span><span class="p">:</span><span class="kt">SimpleLabel</span><span class="o">;</span>
        <span class="kd">protected</span> <span class="kd">var</span> <span class="n">gameTimer</span><span class="p">:</span><span class="kt">Timer</span><span class="o">;</span>

        <span class="kd">override</span> <span class="kd">public</span> <span class="kd">function </span><span class="nf">run</span><span class="o">():</span><span class="kt">void</span>
        <span class="o">{</span>

            <span class="n">stage</span><span class="o">.</span><span class="na">scaleMode</span> <span class="o">=</span> <span class="n">StageScaleMode</span><span class="o">.</span><span class="na">FILL</span><span class="o">;</span>

            <span class="n">var</span> <span class="n">screenWidth</span> <span class="o">=</span> <span class="n">stage</span><span class="o">.</span><span class="na">stageWidth</span><span class="o">;</span>
            <span class="n">var</span> <span class="n">screenHeight</span> <span class="o">=</span> <span class="n">stage</span><span class="o">.</span><span class="na">stageHeight</span><span class="o">;</span>            

            <span class="n">waitTime</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">;</span>
            <span class="n">strikes</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>

            <span class="n">var</span> <span class="n">ground</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">Image</span><span class="o">(</span><span class="n">Texture</span><span class="o">.</span><span class="na">fromAsset</span><span class="o">(</span><span class="s2">&quot;assets/background/bg_dirt.png&quot;</span><span class="o">));</span>
            <span class="n">ground</span><span class="o">.</span><span class="na">x</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
            <span class="n">ground</span><span class="o">.</span><span class="na">y</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
            <span class="n">ground</span><span class="o">.</span><span class="na">touchable</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
            <span class="n">stage</span><span class="o">.</span><span class="na">addChild</span><span class="o">(</span><span class="n">ground</span><span class="o">);</span>

            <span class="n">var</span> <span class="n">top</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">Image</span><span class="o">(</span><span class="n">Texture</span><span class="o">.</span><span class="na">fromAsset</span><span class="o">(</span><span class="s2">&quot;assets/foreground/grass_upper.png&quot;</span><span class="o">));</span>
            <span class="n">top</span><span class="o">.</span><span class="na">x</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
            <span class="n">top</span><span class="o">.</span><span class="na">y</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
            <span class="n">top</span><span class="o">.</span><span class="na">height</span> <span class="o">=</span> <span class="mi">160</span><span class="o">;</span>
            <span class="n">top</span><span class="o">.</span><span class="na">width</span> <span class="o">=</span> <span class="mi">480</span><span class="o">;</span>
            <span class="n">top</span><span class="o">.</span><span class="na">touchable</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
            <span class="n">stage</span><span class="o">.</span><span class="na">addChild</span><span class="o">(</span><span class="n">top</span><span class="o">);</span>

            <span class="n">var</span> <span class="n">mole1</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">Image</span><span class="o">(</span><span class="n">Texture</span><span class="o">.</span><span class="na">fromAsset</span><span class="o">(</span><span class="s2">&quot;assets/sprites/mole_1.png&quot;</span><span class="o">));</span>
            <span class="n">mole1</span><span class="o">.</span><span class="na">x</span> <span class="o">=</span> <span class="mi">50</span><span class="o">;</span>
            <span class="n">mole1</span><span class="o">.</span><span class="na">y</span> <span class="o">=</span> <span class="mi">180</span><span class="o">;</span>
            <span class="n">mole1</span><span class="o">.</span><span class="na">scale</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">;</span>
            <span class="n">stage</span><span class="o">.</span><span class="na">addChild</span><span class="o">(</span><span class="n">mole1</span><span class="o">);</span>

            <span class="n">mole1</span><span class="o">.</span><span class="na">addEventListener</span><span class="o">(</span> <span class="n">TouchEvent</span><span class="o">.</span><span class="na">TOUCH</span><span class="o">,</span> <span class="kd">function</span><span class="o">(</span><span class="n">e</span><span class="o">:</span><span class="n">TouchEvent</span><span class="o">)</span> <span class="o">{</span> 
                <span class="k">if</span> <span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getTouch</span><span class="o">(</span><span class="n">mole1</span><span class="o">,</span> <span class="n">TouchPhase</span><span class="o">.</span><span class="na">BEGAN</span><span class="o">))</span> <span class="o">{</span>                    
                    <span class="n">whackMole</span><span class="o">(</span><span class="n">e</span><span class="o">,</span> <span class="n">mole1</span><span class="o">);</span> 
                <span class="o">}</span> <span class="o">}</span> <span class="o">);</span>            

            <span class="n">var</span> <span class="n">mole2</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">Image</span><span class="o">(</span><span class="n">Texture</span><span class="o">.</span><span class="na">fromAsset</span><span class="o">(</span><span class="s2">&quot;assets/sprites/mole_1.png&quot;</span><span class="o">));</span>
            <span class="n">mole2</span><span class="o">.</span><span class="na">x</span> <span class="o">=</span> <span class="mi">195</span><span class="o">;</span>
            <span class="n">mole2</span><span class="o">.</span><span class="na">y</span> <span class="o">=</span> <span class="mi">180</span><span class="o">;</span>
            <span class="n">mole2</span><span class="o">.</span><span class="na">scale</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">;</span>
            <span class="n">stage</span><span class="o">.</span><span class="na">addChild</span><span class="o">(</span><span class="n">mole2</span><span class="o">);</span>

            <span class="n">mole2</span><span class="o">.</span><span class="na">addEventListener</span><span class="o">(</span> <span class="n">TouchEvent</span><span class="o">.</span><span class="na">TOUCH</span><span class="o">,</span> <span class="kd">function</span><span class="o">(</span><span class="n">e</span><span class="o">:</span><span class="n">TouchEvent</span><span class="o">)</span> <span class="o">{</span> 
                <span class="k">if</span> <span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getTouch</span><span class="o">(</span><span class="n">mole2</span><span class="o">,</span> <span class="n">TouchPhase</span><span class="o">.</span><span class="na">BEGAN</span><span class="o">))</span> <span class="o">{</span>                    
                    <span class="n">whackMole</span><span class="o">(</span><span class="n">e</span><span class="o">,</span> <span class="n">mole2</span><span class="o">);</span>
                <span class="o">}</span> <span class="o">}</span> <span class="o">);</span>            

            <span class="n">var</span> <span class="n">mole3</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">Image</span><span class="o">(</span><span class="n">Texture</span><span class="o">.</span><span class="na">fromAsset</span><span class="o">(</span><span class="s2">&quot;assets/sprites/mole_1.png&quot;</span><span class="o">));</span>
            <span class="n">mole3</span><span class="o">.</span><span class="na">x</span> <span class="o">=</span> <span class="mi">340</span><span class="o">;</span>
            <span class="n">mole3</span><span class="o">.</span><span class="na">y</span> <span class="o">=</span> <span class="mi">180</span><span class="o">;</span>
            <span class="n">mole3</span><span class="o">.</span><span class="na">scale</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">;</span>
            <span class="n">stage</span><span class="o">.</span><span class="na">addChild</span><span class="o">(</span><span class="n">mole3</span><span class="o">);</span>

            <span class="n">mole3</span><span class="o">.</span><span class="na">addEventListener</span><span class="o">(</span> <span class="n">TouchEvent</span><span class="o">.</span><span class="na">TOUCH</span><span class="o">,</span> <span class="kd">function</span><span class="o">(</span><span class="n">e</span><span class="o">:</span><span class="n">TouchEvent</span><span class="o">)</span> <span class="o">{</span> 
                <span class="k">if</span> <span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getTouch</span><span class="o">(</span><span class="n">mole3</span><span class="o">,</span> <span class="n">TouchPhase</span><span class="o">.</span><span class="na">BEGAN</span><span class="o">))</span> <span class="o">{</span>                    
                    <span class="n">whackMole</span><span class="o">(</span><span class="n">e</span><span class="o">,</span> <span class="n">mole3</span><span class="o">);</span>
                <span class="o">}</span> <span class="o">}</span> <span class="o">);</span>            

            <span class="n">moles</span> <span class="o">=</span> <span class="o">[</span><span class="n">mole1</span><span class="o">,</span> <span class="n">mole2</span><span class="o">,</span> <span class="n">mole3</span><span class="o">];</span>
            <span class="n">moleStates</span> <span class="o">=</span> <span class="o">[</span><span class="kc">false</span><span class="o">,</span> <span class="kc">false</span><span class="o">,</span> <span class="kc">false</span><span class="o">];</span>

            <span class="n">var</span> <span class="n">bottom</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">Image</span><span class="o">(</span><span class="n">Texture</span><span class="o">.</span><span class="na">fromAsset</span><span class="o">(</span><span class="s2">&quot;assets/foreground/grass_lower.png&quot;</span><span class="o">));</span>
            <span class="n">bottom</span><span class="o">.</span><span class="na">x</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
            <span class="n">bottom</span><span class="o">.</span><span class="na">y</span> <span class="o">=</span> <span class="mi">160</span><span class="o">;</span>
            <span class="n">bottom</span><span class="o">.</span><span class="na">width</span> <span class="o">=</span> <span class="mi">480</span><span class="o">;</span>    
            <span class="n">bottom</span><span class="o">.</span><span class="na">height</span> <span class="o">=</span> <span class="mi">160</span><span class="o">;</span>   
            <span class="n">bottom</span><span class="o">.</span><span class="na">touchable</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span> 
            <span class="n">stage</span><span class="o">.</span><span class="na">addChild</span><span class="o">(</span><span class="n">bottom</span><span class="o">);</span>

            <span class="n">total</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
            <span class="n">totalScore</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">SimpleLabel</span><span class="o">(</span><span class="s2">&quot;assets/Curse-hd.fnt&quot;</span><span class="o">);</span>
            <span class="n">totalScore</span><span class="o">.</span><span class="na">text</span> <span class="o">=</span> <span class="s2">&quot;Score: 0&quot;</span><span class="o">;</span>
            <span class="n">totalScore</span><span class="o">.</span><span class="na">x</span> <span class="o">=</span> <span class="n">screenWidth</span><span class="sr">/2 - totalScore.size.x*.5/</span><span class="mi">2</span><span class="o">;</span>
            <span class="n">totalScore</span><span class="o">.</span><span class="na">y</span> <span class="o">=</span> <span class="mi">16</span><span class="o">;</span>
            <span class="n">totalScore</span><span class="o">.</span><span class="na">scale</span> <span class="o">=</span> <span class="o">.</span><span class="mi">5</span><span class="o">;</span>
            <span class="n">totalScore</span><span class="o">.</span><span class="na">touchable</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
            <span class="n">stage</span><span class="o">.</span><span class="na">addChild</span><span class="o">(</span><span class="n">totalScore</span><span class="o">);</span>

            <span class="n">retryButton</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">Image</span><span class="o">(</span><span class="n">Texture</span><span class="o">.</span><span class="na">fromAsset</span><span class="o">(</span><span class="s2">&quot;assets/retry.png&quot;</span><span class="o">));</span>
            <span class="n">retryButton</span><span class="o">.</span><span class="na">x</span> <span class="o">=</span> <span class="n">screenWidth</span><span class="sr">/2 - retryButton.width*.5/</span><span class="mi">2</span><span class="o">;</span>
            <span class="n">retryButton</span><span class="o">.</span><span class="na">y</span> <span class="o">=</span> <span class="n">screenHeight</span> <span class="o">-</span> <span class="mi">24</span> <span class="o">-</span> <span class="n">retryButton</span><span class="o">.</span><span class="na">height</span><span class="o">/</span><span class="mi">2</span><span class="o">;</span>
            <span class="n">retryButton</span><span class="o">.</span><span class="na">scale</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">;</span>

            <span class="n">retryButton</span><span class="o">.</span><span class="na">addEventListener</span><span class="o">(</span> <span class="n">TouchEvent</span><span class="o">.</span><span class="na">TOUCH</span><span class="o">,</span> <span class="kd">function</span><span class="o">(</span><span class="n">e</span><span class="o">:</span><span class="n">TouchEvent</span><span class="o">)</span> <span class="o">{</span> 
                <span class="k">if</span> <span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getTouch</span><span class="o">(</span><span class="n">retryButton</span><span class="o">,</span> <span class="n">TouchPhase</span><span class="o">.</span><span class="na">BEGAN</span><span class="o">))</span>
                <span class="o">{</span>
                    <span class="n">resetGame</span><span class="o">();</span>
                    <span class="n">e</span><span class="o">.</span><span class="na">stopImmediatePropagation</span><span class="o">();</span>
                <span class="o">}</span>
            <span class="o">}</span> <span class="o">);</span>            

            <span class="n">timeLabel</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">SimpleLabel</span><span class="o">(</span><span class="s2">&quot;assets/Curse-hd.fnt&quot;</span><span class="o">);</span>
            <span class="n">timeLabel</span><span class="o">.</span><span class="na">text</span> <span class="o">=</span> <span class="s2">&quot;30&quot;</span><span class="o">;</span>
            <span class="n">timeLabel</span><span class="o">.</span><span class="na">x</span> <span class="o">=</span> <span class="mi">410</span><span class="o">;</span>
            <span class="n">timeLabel</span><span class="o">.</span><span class="na">y</span> <span class="o">=</span> <span class="mi">16</span><span class="o">;</span>
            <span class="n">timeLabel</span><span class="o">.</span><span class="na">scale</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">;</span>
            <span class="n">timeLabel</span><span class="o">.</span><span class="na">touchable</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
            <span class="n">stage</span><span class="o">.</span><span class="na">addChild</span><span class="o">(</span><span class="n">timeLabel</span><span class="o">);</span>

            <span class="n">gameTimer</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">Timer</span><span class="o">(</span><span class="mi">30000</span><span class="o">);</span>
            <span class="n">gameTimer</span><span class="o">.</span><span class="na">onComplete</span> <span class="o">=</span> <span class="n">endGame</span><span class="o">;</span>
            <span class="n">gameTimer</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>

            <span class="n">timer</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">Timer</span><span class="o">(</span><span class="mi">1000</span><span class="o">);</span>
            <span class="n">timer</span><span class="o">.</span><span class="na">onComplete</span> <span class="o">=</span> <span class="n">onTimerComplete</span><span class="o">;</span>
            <span class="n">timer</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>

            <span class="n">stage</span><span class="o">.</span><span class="na">addEventListener</span><span class="o">(</span> <span class="n">TouchEvent</span><span class="o">.</span><span class="na">TOUCH</span><span class="o">,</span> <span class="kd">function</span><span class="o">(</span><span class="n">e</span><span class="o">:</span><span class="n">TouchEvent</span><span class="o">)</span> <span class="o">{</span> 

                <span class="n">var</span> <span class="n">touch</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="na">getTouch</span><span class="o">(</span><span class="n">stage</span><span class="o">,</span> <span class="n">TouchPhase</span><span class="o">.</span><span class="na">BEGAN</span><span class="o">);</span>

                <span class="k">if</span> <span class="o">(!</span><span class="n">touch</span><span class="o">)</span>
                    <span class="k">return</span><span class="o">;</span>                

                <span class="n">onMiss</span><span class="o">(</span><span class="n">touch</span><span class="o">.</span><span class="na">globalX</span><span class="o">,</span> <span class="n">touch</span><span class="o">.</span><span class="na">globalY</span><span class="o">);</span>

            <span class="o">}</span> <span class="o">);</span>            

            <span class="n">createScoreLabels</span><span class="o">();</span>
        <span class="o">}</span>

        <span class="kd">override</span> <span class="kd">public</span> <span class="kd">function </span><span class="nf">onTick</span><span class="o">()</span>
        <span class="o">{</span>
            <span class="n">timeLabel</span><span class="o">.</span><span class="na">text</span> <span class="o">=</span> <span class="o">(</span><span class="mi">30</span><span class="o">-</span><span class="n">Math</span><span class="o">.</span><span class="na">round</span><span class="o">(</span><span class="n">gameTimer</span><span class="o">.</span><span class="na">elapsed</span><span class="o">/</span><span class="mi">1000</span><span class="o">)).</span><span class="n">toString</span><span class="o">();</span>
        <span class="o">}</span>

        <span class="kd">protected</span> <span class="kd">function </span><span class="nf">createScoreLabels</span><span class="o">()</span>
        <span class="o">{</span>
            <span class="c1">// create a pool a score labels to pull from</span>
            <span class="n">scores</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">Vector.&lt;SimpleLabel&gt;</span><span class="o">();</span>
            <span class="n">misses</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">Vector.&lt;SimpleLabel&gt;</span><span class="o">();</span>
            <span class="k">for</span><span class="o">(</span><span class="n">var</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="mi">4</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span>
            <span class="o">{</span>
                <span class="n">var</span> <span class="n">score</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">SimpleLabel</span><span class="o">(</span><span class="s2">&quot;assets/Curse-hd.fnt&quot;</span><span class="o">);</span>
                <span class="n">score</span><span class="o">.</span><span class="na">text</span> <span class="o">=</span> <span class="s2">&quot;+100&quot;</span><span class="o">;</span>
                <span class="n">score</span><span class="o">.</span><span class="na">scale</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">;</span>
                <span class="n">score</span><span class="o">.</span><span class="na">y</span> <span class="o">=</span> <span class="mi">400</span><span class="o">;</span>
                <span class="n">score</span><span class="o">.</span><span class="na">touchable</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
                <span class="n">scores</span><span class="o">.</span><span class="na">push</span><span class="o">(</span><span class="n">score</span><span class="o">);</span>
                <span class="n">stage</span><span class="o">.</span><span class="na">addChild</span><span class="o">(</span><span class="n">score</span><span class="o">);</span>

                <span class="n">var</span> <span class="n">miss</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">SimpleLabel</span><span class="o">(</span><span class="s2">&quot;assets/Red-hd.fnt&quot;</span><span class="o">);</span>
                <span class="n">miss</span><span class="o">.</span><span class="na">text</span> <span class="o">=</span> <span class="s2">&quot;miss&quot;</span><span class="o">;</span>
                <span class="n">miss</span><span class="o">.</span><span class="na">y</span> <span class="o">=</span> <span class="mi">400</span><span class="o">;</span>
                <span class="n">miss</span><span class="o">.</span><span class="na">touchable</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
                <span class="n">misses</span><span class="o">.</span><span class="na">push</span><span class="o">(</span><span class="n">miss</span><span class="o">);</span>
                <span class="n">stage</span><span class="o">.</span><span class="na">addChild</span><span class="o">(</span><span class="n">miss</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">}</span>

        <span class="kd">protected</span> <span class="kd">function </span><span class="nf">getAvailableScoreLabel</span><span class="o">():</span><span class="kt">SimpleLabel</span>
        <span class="o">{</span>
            <span class="k">for</span><span class="o">(</span><span class="n">var</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">scores</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span>
            <span class="o">{</span>
                <span class="n">var</span> <span class="n">score</span> <span class="o">=</span> <span class="n">scores</span><span class="o">[</span><span class="n">i</span><span class="o">];</span>
                <span class="k">if</span><span class="o">(!</span><span class="n">Loom2D</span><span class="o">.</span><span class="na">juggler</span><span class="o">.</span><span class="na">containsTweens</span><span class="o">(</span><span class="n">score</span><span class="o">))</span>
                    <span class="k">return</span> <span class="n">score</span><span class="o">;</span>
            <span class="o">}</span>

            <span class="c1">// default, return the first one</span>
            <span class="n">Loom2D</span><span class="o">.</span><span class="na">juggler</span><span class="o">.</span><span class="na">removeTweens</span><span class="o">(</span><span class="n">scores</span><span class="o">[</span><span class="mi">0</span><span class="o">]);</span>
            <span class="k">return</span> <span class="n">scores</span><span class="o">[</span><span class="mi">0</span><span class="o">];</span>
        <span class="o">}</span>

        <span class="kd">protected</span> <span class="kd">function </span><span class="nf">getAvailableMissLabel</span><span class="o">():</span><span class="kt">SimpleLabel</span>
        <span class="o">{</span>
            <span class="k">for</span><span class="o">(</span><span class="n">var</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">misses</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span>
            <span class="o">{</span>
                <span class="n">var</span> <span class="n">miss</span> <span class="o">=</span> <span class="n">misses</span><span class="o">[</span><span class="n">i</span><span class="o">];</span>
                <span class="k">if</span><span class="o">(!</span><span class="n">Loom2D</span><span class="o">.</span><span class="na">juggler</span><span class="o">.</span><span class="na">containsTweens</span><span class="o">(</span><span class="n">miss</span><span class="o">))</span>
                    <span class="k">return</span> <span class="n">miss</span><span class="o">;</span>
            <span class="o">}</span>

            <span class="c1">// default, return the first one</span>
            <span class="n">Loom2D</span><span class="o">.</span><span class="na">juggler</span><span class="o">.</span><span class="na">removeTweens</span><span class="o">(</span><span class="n">misses</span><span class="o">[</span><span class="mi">0</span><span class="o">]);</span>
            <span class="k">return</span> <span class="n">misses</span><span class="o">[</span><span class="mi">0</span><span class="o">];</span>
        <span class="o">}</span>

        <span class="kd">protected</span> <span class="kd">function </span><span class="nf">onTimerComplete</span><span class="o">(</span><span class="n">timer</span><span class="o">:</span><span class="kt">Timer</span><span class="o">)</span>
        <span class="o">{</span>
            <span class="k">for</span><span class="o">(</span><span class="n">var</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">moles</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span>
            <span class="o">{</span>
                <span class="k">if</span><span class="o">(</span><span class="n">Math</span><span class="o">.</span><span class="na">floor</span><span class="o">(</span><span class="n">Math</span><span class="o">.</span><span class="na">random</span><span class="o">()*</span><span class="mi">4</span><span class="o">)</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span>
                <span class="o">{</span>
                    <span class="n">var</span> <span class="n">mole</span> <span class="o">=</span> <span class="n">moles</span><span class="o">[</span><span class="n">i</span><span class="o">];</span>

                    <span class="k">if</span><span class="o">(</span><span class="n">moleStates</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">==</span> <span class="kc">true</span><span class="o">)</span> <span class="o">{</span>
                        <span class="n">moleStates</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
                        <span class="n">mole</span><span class="o">.</span><span class="na">source</span> <span class="o">=</span> <span class="s2">&quot;assets/sprites/mole_1.png&quot;</span><span class="o">;</span>
                    <span class="o">}</span>

                    <span class="k">if</span><span class="o">(!</span><span class="n">Loom2D</span><span class="o">.</span><span class="na">juggler</span><span class="o">.</span><span class="na">containsTweens</span><span class="o">(</span><span class="n">mole</span><span class="o">))</span>
                    <span class="o">{</span>
                        <span class="n">Loom2D</span><span class="o">.</span><span class="na">juggler</span><span class="o">.</span><span class="na">tween</span><span class="o">(</span><span class="n">mole</span><span class="o">,</span> <span class="mf">0.5</span><span class="o">,</span> <span class="o">{</span><span class="s2">&quot;y&quot;</span><span class="o">:</span> <span class="mi">85</span><span class="o">,</span> <span class="s2">&quot;transition&quot;</span><span class="o">:</span> <span class="n">Transitions</span><span class="o">.</span><span class="na">EASE_OUT</span><span class="o">});</span>
                        <span class="n">Loom2D</span><span class="o">.</span><span class="na">juggler</span><span class="o">.</span><span class="na">tween</span><span class="o">(</span><span class="n">mole</span><span class="o">,</span> <span class="mf">0.3</span><span class="o">,</span> <span class="o">{</span><span class="s2">&quot;y&quot;</span><span class="o">:</span> <span class="mi">180</span><span class="o">,</span> <span class="s2">&quot;transition&quot;</span><span class="o">:</span> <span class="n">Transitions</span><span class="o">.</span><span class="na">EASE_OUT</span><span class="o">,</span> <span class="s2">&quot;delay&quot;</span><span class="o">:</span> <span class="mf">0.5</span><span class="o">+</span><span class="n">waitTime</span><span class="o">});</span>
                    <span class="o">}</span>
                <span class="o">}</span>
            <span class="o">}</span>

            <span class="c1">// play the timer again</span>
            <span class="n">timer</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>
        <span class="o">}</span>

        <span class="kd">protected</span> <span class="kd">function </span><span class="nf">whackMole</span><span class="o">(</span><span class="n">e</span><span class="o">:</span><span class="kt">TouchEvent</span><span class="o">,</span> <span class="n">mole</span><span class="o">:</span><span class="kt">Image</span><span class="o">)</span>
        <span class="o">{</span>

            <span class="k">if</span><span class="o">(</span><span class="n">strikes</span> <span class="o">==</span> <span class="mi">3</span><span class="o">)</span> 
                <span class="k">return</span><span class="o">;</span>

            <span class="n">var</span> <span class="n">index</span> <span class="o">=</span> <span class="n">moles</span><span class="o">.</span><span class="na">indexOf</span><span class="o">(</span><span class="n">mole</span><span class="o">);</span>

            <span class="k">if</span><span class="o">(</span><span class="n">moleStates</span><span class="o">[</span><span class="n">index</span><span class="o">]</span> <span class="o">==</span> <span class="kc">false</span> <span class="o">&amp;&amp;</span> <span class="n">mole</span><span class="o">.</span><span class="na">y</span> <span class="o">&lt;</span> <span class="mi">125</span><span class="o">)</span> 
            <span class="o">{</span>
                <span class="c1">// increase the difficulty as we get more moles</span>
                <span class="n">waitTime</span> <span class="o">*=</span> <span class="mf">0.9</span><span class="o">;</span>
                <span class="n">timer</span><span class="o">.</span><span class="na">delay</span> <span class="o">*=</span> <span class="mf">0.9</span><span class="o">;</span>

                <span class="c1">// update our whacked state</span>
                <span class="n">moleStates</span><span class="o">[</span><span class="n">index</span><span class="o">]</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>

                <span class="c1">// animate a score</span>
                <span class="n">var</span> <span class="n">score</span> <span class="o">=</span> <span class="n">getAvailableScoreLabel</span><span class="o">();</span>
                <span class="n">score</span><span class="o">.</span><span class="na">x</span> <span class="o">=</span> <span class="n">mole</span><span class="o">.</span><span class="na">x</span><span class="o">;</span>
                <span class="n">score</span><span class="o">.</span><span class="na">y</span> <span class="o">=</span> <span class="n">mole</span><span class="o">.</span><span class="na">y</span><span class="o">;</span>
                <span class="n">score</span><span class="o">.</span><span class="na">scale</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>

                <span class="n">total</span> <span class="o">+=</span> <span class="mi">100</span><span class="o">;</span>
                <span class="n">totalScore</span><span class="o">.</span><span class="na">text</span> <span class="o">=</span> <span class="s2">&quot;Score: &quot;</span> <span class="o">+</span> <span class="n">total</span><span class="o">.</span><span class="na">toString</span><span class="o">();</span>
                <span class="c1">// center</span>
                <span class="n">totalScore</span><span class="o">.</span><span class="na">x</span> <span class="o">=</span> <span class="n">stage</span><span class="o">.</span><span class="na">stageWidth</span><span class="sr">/2 - totalScore.size.x*.5/</span><span class="mi">2</span><span class="o">;</span>

                <span class="n">Loom2D</span><span class="o">.</span><span class="na">juggler</span><span class="o">.</span><span class="na">tween</span><span class="o">(</span><span class="n">score</span><span class="o">,</span> <span class="mf">0.3</span><span class="o">,</span> <span class="o">{</span><span class="s2">&quot;scaleX&quot;</span><span class="o">:</span> <span class="mf">0.5</span><span class="o">,</span> <span class="s2">&quot;transition&quot;</span><span class="o">:</span> <span class="n">Transitions</span><span class="o">.</span><span class="na">EASE_OUT_BACK</span><span class="o">});</span>
                <span class="n">Loom2D</span><span class="o">.</span><span class="na">juggler</span><span class="o">.</span><span class="na">tween</span><span class="o">(</span><span class="n">score</span><span class="o">,</span> <span class="mf">0.3</span><span class="o">,</span> <span class="o">{</span><span class="s2">&quot;scaleY&quot;</span><span class="o">:</span> <span class="mf">0.5</span><span class="o">,</span> <span class="s2">&quot;transition&quot;</span><span class="o">:</span> <span class="n">Transitions</span><span class="o">.</span><span class="na">EASE_OUT_BACK</span><span class="o">});</span>
                <span class="n">Loom2D</span><span class="o">.</span><span class="na">juggler</span><span class="o">.</span><span class="na">tween</span><span class="o">(</span><span class="n">score</span><span class="o">,</span> <span class="mf">0.3</span><span class="o">,</span> <span class="o">{</span><span class="s2">&quot;y&quot;</span><span class="o">:</span> <span class="o">-</span><span class="mi">100</span><span class="o">,</span> <span class="s2">&quot;transition&quot;</span><span class="o">:</span> <span class="n">Transitions</span><span class="o">.</span><span class="na">EASE_IN_BACK</span><span class="o">,</span> <span class="s2">&quot;delay&quot;</span><span class="o">:</span> <span class="mf">0.3</span><span class="o">});</span>

                <span class="n">Loom2D</span><span class="o">.</span><span class="na">juggler</span><span class="o">.</span><span class="na">removeTweens</span><span class="o">(</span><span class="n">mole</span><span class="o">);</span>
                <span class="n">mole</span><span class="o">.</span><span class="na">source</span> <span class="o">=</span> <span class="s2">&quot;assets/sprites/mole_thump4.png&quot;</span><span class="o">;</span>
                <span class="n">Loom2D</span><span class="o">.</span><span class="na">juggler</span><span class="o">.</span><span class="na">tween</span><span class="o">(</span><span class="n">mole</span><span class="o">,</span> <span class="mf">0.3</span><span class="o">,</span> <span class="o">{</span><span class="s2">&quot;y&quot;</span><span class="o">:</span> <span class="mi">180</span><span class="o">,</span> <span class="s2">&quot;transition&quot;</span><span class="o">:</span> <span class="n">Transitions</span><span class="o">.</span><span class="na">EASE_OUT</span><span class="o">,</span> <span class="s2">&quot;delay&quot;</span><span class="o">:</span> <span class="mf">0.1</span><span class="o">});</span>

                <span class="c1">// stop the event propogating to the miss handler</span>
                <span class="n">e</span><span class="o">.</span><span class="na">stopImmediatePropagation</span><span class="o">();</span>
            <span class="o">}</span>
        <span class="o">}</span>

        <span class="kd">protected</span> <span class="kd">function </span><span class="nf">onMiss</span><span class="o">(</span><span class="n">x</span><span class="o">:</span><span class="kt">Number</span><span class="o">,</span> <span class="n">y</span><span class="o">:</span><span class="kt">Number</span><span class="o">)</span>
        <span class="o">{</span>
            <span class="k">if</span><span class="o">(</span><span class="n">strikes</span> <span class="o">==</span> <span class="mi">3</span><span class="o">)</span> 
                <span class="k">return</span><span class="o">;</span>

            <span class="n">strikes</span><span class="o">++;</span>

            <span class="n">var</span> <span class="n">miss</span> <span class="o">=</span> <span class="n">getAvailableMissLabel</span><span class="o">();</span>
            <span class="n">miss</span><span class="o">.</span><span class="na">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">miss</span><span class="o">.</span><span class="na">width</span><span class="o">/</span><span class="mi">2</span><span class="o">;</span>
            <span class="n">miss</span><span class="o">.</span><span class="na">y</span> <span class="o">=</span> <span class="n">y</span> <span class="o">-</span> <span class="n">miss</span><span class="o">.</span><span class="na">height</span><span class="o">/</span><span class="mi">2</span><span class="o">;</span>
            <span class="n">miss</span><span class="o">.</span><span class="na">scale</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>

            <span class="n">Loom2D</span><span class="o">.</span><span class="na">juggler</span><span class="o">.</span><span class="na">tween</span><span class="o">(</span><span class="n">miss</span><span class="o">,</span> <span class="mf">0.3</span><span class="o">,</span> <span class="o">{</span><span class="s2">&quot;scaleX&quot;</span><span class="o">:</span> <span class="mf">0.5</span><span class="o">,</span> <span class="s2">&quot;scaleY&quot;</span><span class="o">:</span> <span class="mf">0.5</span><span class="o">,</span> <span class="s2">&quot;transition&quot;</span><span class="o">:</span> <span class="n">Transitions</span><span class="o">.</span><span class="na">EASE_OUT_BACK</span><span class="o">});</span>
            <span class="n">Loom2D</span><span class="o">.</span><span class="na">juggler</span><span class="o">.</span><span class="na">tween</span><span class="o">(</span><span class="n">miss</span><span class="o">,</span> <span class="mf">0.3</span><span class="o">,</span> <span class="o">{</span><span class="s2">&quot;y&quot;</span><span class="o">:</span> <span class="o">-</span><span class="mi">100</span><span class="o">,</span> <span class="s2">&quot;transition&quot;</span><span class="o">:</span> <span class="n">Transitions</span><span class="o">.</span><span class="na">EASE_IN_BACK</span><span class="o">,</span> <span class="s2">&quot;delay&quot;</span><span class="o">:</span> <span class="mf">0.3</span><span class="o">});</span>

            <span class="k">if</span><span class="o">(</span><span class="n">strikes</span> <span class="o">==</span> <span class="mi">3</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">endGame</span><span class="o">();</span>
            <span class="o">}</span>
        <span class="o">}</span>

        <span class="kd">protected</span> <span class="kd">function </span><span class="nf">endGame</span><span class="o">(</span><span class="n">t</span><span class="o">:</span><span class="kt">Timer</span><span class="o">=</span><span class="kc">null</span><span class="o">)</span>
        <span class="o">{</span>
            <span class="n">strikes</span> <span class="o">=</span> <span class="mi">3</span><span class="o">;</span>
            <span class="n">stage</span><span class="o">.</span><span class="na">removeChild</span><span class="o">(</span><span class="n">timeLabel</span><span class="o">);</span>
            <span class="n">timer</span><span class="o">.</span><span class="na">stop</span><span class="o">();</span>
            <span class="n">gameTimer</span><span class="o">.</span><span class="na">stop</span><span class="o">();</span>

            <span class="k">if</span><span class="o">(</span><span class="n">retryButton</span><span class="o">.</span><span class="na">parent</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span>
                <span class="n">stage</span><span class="o">.</span><span class="na">addChild</span><span class="o">(</span><span class="n">retryButton</span><span class="o">);</span>
        <span class="o">}</span>

        <span class="kd">protected</span> <span class="kd">function </span><span class="nf">resetGame</span><span class="o">()</span>
        <span class="o">{</span>
            <span class="n">stage</span><span class="o">.</span><span class="na">addChild</span><span class="o">(</span><span class="n">timeLabel</span><span class="o">);</span>
            <span class="n">strikes</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
            <span class="n">total</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
            <span class="n">totalScore</span><span class="o">.</span><span class="na">text</span> <span class="o">=</span> <span class="s2">&quot;Score: 0&quot;</span><span class="o">;</span>
            <span class="n">totalScore</span><span class="o">.</span><span class="na">x</span> <span class="o">=</span> <span class="n">stage</span><span class="o">.</span><span class="na">stageWidth</span><span class="sr">/2 - totalScore.size.x*.5/</span><span class="mi">2</span><span class="o">;</span>
            <span class="n">timer</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>
            <span class="n">gameTimer</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>
            <span class="n">stage</span><span class="o">.</span><span class="na">removeChild</span><span class="o">(</span><span class="n">retryButton</span><span class="o">);</span>
            <span class="n">waitTime</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">;</span>
            <span class="n">timer</span><span class="o">.</span><span class="na">delay</span> <span class="o">=</span> <span class="mi">1000</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
            </p>
          </div>
        </div>

        <script type="text/javascript" src="../../js/vendor/fuse.min.js"></script>
<script type="text/javascript" src="../../js/vendor/jquery-1.9.0.min.js"></script>
<script type="text/javascript" src="../../js/vendor/jquery.easing.min.js"></script>
<script type="text/javascript" src="../../js/vendor/jquery-ui-1.10.3.custom.min.js"></script>
<script type="text/javascript" src="../../js/vendor/underscore-min.js"></script>
<script type="text/javascript" src="../../js/authored/onscroll.js"></script>
<script type="text/javascript" src="../../js/authored/table-of-contents.js"></script>
<script type="text/javascript" src="../../js/authored/inherited-properties.js"></script>
<script type="text/javascript" src="../../js/authored/twirldowns.js"></script>
<script type="text/javascript" src="../../js/authored/id-link-intercept.js"></script>
<script type="text/javascript">
  $(function() {
    $( document ).tooltip();
  });
  </script>
<script type="text/javascript">
  var relative_base = "../..";
</script>
<script type="text/javascript" src="../../js/data.js"></script>:
<script type="text/javascript" src="../../js/authored/sidebar.js"></script>
<script type="text/javascript" src="../../js/vendor/jquery.dropdown.js"></script>
<script type="text/javascript" src="../../js/authored/search.js"></script>

        <script type="text/javascript" src="../../js/authored/table-of-contents-h2s.js"></script>

    </body>
</html>
